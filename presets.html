<!DOCTYPE html>
<html lang="en">
<head>
<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#8b5cf6">
<meta name="apple-mobile-web-app-capable" content="yes">
 
 <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GFG0RYJNR0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-GFG0RYJNR0');
    </script>
    
    <!-- DOMPurify - XSS Protection -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Response Templates - DMTools.fun</title>
    <meta name="description" content="Create and manage custom response templates for any digital messaging platform. Save time with pre-built responses.">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #ffffff;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

     /* Header Container */
.header {
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #1e293b;
    padding: 1rem 0;
    position: sticky;
    top: 0;
    z-index: 100;
}

/* Nav Container - Logo, Back Button, Auth */
.nav-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
}

/* Logo */
.logo {
    font-size: 1.8rem;
    font-weight: 900;
    background: linear-gradient(135deg, #8b5cf6, #06b6d4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    cursor: pointer;
    text-decoration: none;
}

/* Back to App Button */
.nav-back {
    background: #374151;
    color: #ffffff;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    text-decoration: none;
    border: 1px solid #4b5563;
    transition: all 0.3s ease;
}

.nav-back:hover {
    border-color: #8b5cf6;
    color: #8b5cf6;
}

/* Navigation Tabs */
.nav-tabs {
    display: flex;
    justify-content: center;
    gap: 1rem;
    padding: 1rem 2rem;
    border-top: 1px solid #1e293b;
}

/* Tab Buttons */
.tab-btn {
    background: transparent;
    border: 1px solid #374151;
    color: #9ca3af;
    padding: 0.5rem 1.5rem;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
    cursor: pointer;
    font-size: 0.7rem;
}

.tab-btn:hover,
.tab-btn.active {
    border-color: #8b5cf6;
    color: #8b5cf6;
    background: rgba(139, 92, 246, 0.1);
}

.tab-btn.active {
    background: rgba(139, 92, 246, 0.2);
}

/* ========================================
   AUTH BUTTONS STYLES
   ======================================== */

.auth-buttons {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.user-section {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.user-email {
    color: #e5e7eb;
    font-weight: 500;
    font-size: 0.9rem;
}

/* Buttons */
.btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.btn-primary {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    color: white;
    border: none;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
}

.btn-secondary {
    background: #374151;
    color: #ffffff;
    border: 1px solid #4b5563;
}

.btn-secondary:hover {
    border-color: #8b5cf6;
    color: #8b5cf6;
}

/* Hidden utility class */
.hidden {
    display: none !important;
}

/* ========================================
   MOBILE RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
    .nav-container {
        flex-wrap: wrap;
        gap: 1rem;
        padding: 0 1rem;
    }
    
    .nav-tabs {
        flex-wrap: wrap;
        gap: 0.5rem;
        padding: 1rem;
    }
    
    .tab-btn {
        padding: 0.5rem 1rem;
        font-size: 0.65rem;
    }
    
    .auth-buttons {
        gap: 0.5rem;
    }
    
    .btn {
        padding: 0.4rem 0.75rem;
        font-size: 0.8rem;
    }
    
    .user-email {
        display: none; /* Hide email on mobile, just show logout */
    }
}

        /* Main Content */
        .main-content {
            padding: 2rem 0;
        }

        /* Page Header with Usage Tracking */
        .page-header {
            text-align: center;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-description {
            font-size: 1.1rem;
            color: #9ca3af;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Template Usage Tracker */
        .usage-tracker {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid #8b5cf6;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .usage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .usage-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: #8b5cf6;
        }

        .plan-badge {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .progress-bar {
            background: #374151;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-fill {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .upgrade-hint {
            color: #9ca3af;
            font-size: 0.9rem;
        }

        /* Value Proposition Section */
        .value-section {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #334155;
        }

        .value-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .value-card {
            text-align: center;
            padding: 1.5rem;
            background: rgba(139, 92, 246, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(139, 92, 246, 0.2);
        }

        .value-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .value-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
        }

        .value-description {
            color: #9ca3af;
            font-size: 0.9rem;
        }

        /* Templates Section */
        .templates-section {
            background: #1f2937;
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid #374151;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
        }

        /* Enhanced Template Form */
        .template-form {
            background: #374151;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #4b5563;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            color: #e5e7eb;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .form-input, .form-select, .form-textarea {
            background: #1f2937;
            border: 1px solid #4b5563;
            color: #ffffff;
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Live Preview */
        .preview-section {
            background: #1f2937;
            border: 1px solid #4b5563;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .preview-label {
            color: #9ca3af;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            font-weight: 600;
        }

        .preview-content {
            color: #e5e7eb;
            font-style: italic;
            min-height: 40px;
            padding: 0.5rem;
            background: rgba(139, 92, 246, 0.05);
            border-radius: 6px;
        }

        /* Template Cards */
        .template-grid {
            display: grid;
            gap: 1rem;
        }

        .template-card {
            background: #374151;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #4b5563;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            border-color: #8b5cf6;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.1);
        }

        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .template-info {
            flex: 1;
        }

        .template-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .template-category {
            background: #8b5cf6;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }

        .template-actions {
            display: flex;
            gap: 0.5rem;
            flex-shrink: 0;
        }

        .copy-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .copy-btn:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .copy-btn.copied {
            background: #06b6d4;
        }

        .delete-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .template-response {
            color: #e5e7eb;
            line-height: 1.6;
            background: rgba(15, 23, 42, 0.5);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 3px solid #8b5cf6;
        }

        .template-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .tag {
            background: rgba(139, 92, 246, 0.2);
            color: #a78bfa;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        /* Example Templates Section */
        .examples-section {
            margin-bottom: 2rem;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .example-card {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid #8b5cf6;
            border-radius: 12px;
            padding: 1.5rem;
        }

        .example-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .example-name {
            font-weight: 600;
            color: #ffffff;
        }

        .example-response {
            color: #e5e7eb;
            margin-bottom: 1rem;
            font-style: italic;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #9ca3af;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #e5e7eb;
        }

        .empty-description {
            margin-bottom: 2rem;
        }

        /* Authentication Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .auth-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .auth-modal-content {
            background: #1f2937;
            border-radius: 16px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            border: 1px solid #374151;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #374151;
            color: #ffffff;
        }

        .auth-modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid #ef4444;
            color: #ef4444;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid #10b981;
            color: #10b981;
            padding: 0.75rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .hidden {
            display: none !important;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-tabs {
                display: none;
            }
            
            .form-grid {
                grid-template-columns: 1fr !important;
            }
            
            .usage-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .template-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .template-actions {
                align-self: stretch;
                justify-content: space-between;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .value-grid {
                grid-template-columns: 1fr;
            }
            
            .examples-grid {
                grid-template-columns: 1fr;
            }
        }
     /* ========================================
   HEADER FIX - Static with Smaller Icons
   ======================================== */

/* Remove sticky/fixed positioning - make header static */
.header,
header,
.site-header,
.main-header {
    position: static !important; /* Not sticky or fixed */
    top: auto !important;
    z-index: 100;
}

/* Make header compact with reasonable height */
.header,
header,
.site-header,
.main-header {
    padding: 0.75rem 0 !important; /* Reduced from likely 1.5rem or more */
    min-height: auto !important;
    height: auto !important;
}

/* Navigation container */
.header nav,
.header-nav,
.main-nav,
header nav {
    display: flex;
    align-items: center;
    gap: 1.5rem; /* Space between nav items */
}

/* Navigation links - make icons smaller */
.header nav a,
.header-nav a,
.main-nav a,
header nav a,
.nav-link {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
    text-decoration: none;
    font-size: 0.9rem; /* Slightly smaller text */
    transition: all 0.3s ease;
}

/* Icons/Emoji in navigation - reduce size */
.header nav a::before,
.header-nav a::before,
.main-nav a::before,
header nav a span:first-child,
.nav-icon {
    font-size: 1.25rem !important; /* Smaller icons - was probably 2rem+ */
    line-height: 1;
    display: block;
}

/* If icons are actual elements with class */
.header .icon,
.nav-item .icon,
header .icon {
    width: 24px !important; /* Fixed icon size */
    height: 24px !important;
    font-size: 1.25rem !important;
}

/* Adjust header content container */
.header-content,
.header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 2rem;
    max-width: 1400px;
    margin: 0 auto;
}

/* Logo area */
.logo {
    font-size: 1.5rem !important;
    font-weight: 700;
}

/* Right side buttons (Welcome, Open App) */
.header-actions,
.header-right,
.user-menu {
    display: flex;
    align-items: center;
    gap: 1rem;
}

/* Compact button styling */
.header-actions button,
.header-actions a,
.btn-header {
    padding: 0.5rem 1rem !important; /* Smaller padding */
    font-size: 0.9rem !important;
    white-space: nowrap;
}

/* PWA Install prompt - make it less intrusive */
.pwa-prompt,
.install-prompt {
    position: fixed !important; /* Keep this fixed */
    top: 80px !important; /* Below header */
    right: 20px;
    z-index: 999;
    max-width: 280px;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .header nav {
        gap: 1rem; /* Less space on mobile */
    }
    
    .header nav a {
        font-size: 0.75rem;
    }
    
    .header nav a::before,
    .header nav a span:first-child {
        font-size: 1rem !important; /* Even smaller icons on mobile */
    }
}

/* ========================================
   SPECIFIC FIX FOR YOUR SCREENSHOT
   ======================================== */

/* The navigation items: Generator, Templates, Packs, Analytics, Contact, Pricing, Account */
nav a,
.nav-item {
    font-size: 0.875rem !important; /* 14px */
}

/* The emoji/icons before text */
nav a > span:first-child,
.nav-item-icon {
    font-size: 1.125rem !important; /* 18px - much smaller than before */
    margin-bottom: 2px;
}

/* Ensure header doesn't grow */
.header {
    max-height: 70px !important;
    overflow: visible;
}

/* Fix any padding issues */
.header,
header {
    padding-top: 0.5rem !important;
    padding-bottom: 0.5rem !important;
}
     
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <a href="/" class="logo">DMTools.fun</a>
            <a href="/app.html" class="nav-back">â† Back to App</a>
        </div>
        <nav class="nav-tabs">
            <a href="/app.html" class="tab-btn">Generator</a>
            <a href="/presets.html" class="tab-btn">Templates</a>
            <a href="/analytics.html" class="tab-btn">Analytics</a>
            <a href="/packs.html" class="tab-btn">Response Packs</a>
            <a href="/pricing.html" class="tab-btn">Pricing</a>
            <a href="/store.html" class="tab-btn">Packs Store</a>
            <a href="/account.html" class="tab-btn">Account</a>
        </nav>
    
        <!-- Auth Section - Shows Sign In/Up when logged out -->
        <div id="auth-section" class="auth-buttons">
            <button class="btn btn-secondary" onclick="showAuthModal(true)">Sign In</button>
            <button class="btn btn-primary" onclick="showAuthModal(false)">Sign Up</button>
        </div>
    
        <!-- User Section - Shows when logged in -->
        <div id="user-section" class="user-section hidden">
            <span class="user-email" id="user-email">user@example.com</span>
            <button class="btn btn-secondary" onclick="logout()">Sign Out</button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">ğŸ“ Response Templates</h1>
                <p class="page-description">
                    Create and manage your custom response templates for quick access. 
                    Save your best responses and reuse them instantly across all platforms.
                </p>

                <!-- Template Usage Tracker -->
                <div class="usage-tracker" id="usage-tracker">
                    <div class="usage-header">
                        <div class="usage-count">
                            <span id="template-count">0</span> of <span id="template-limit">5</span> Templates Used
                        </div>
                        <div class="plan-badge" id="plan-badge">Free Plan</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="usage-progress" style="width: 0%"></div>
                    </div>
                    <div class="upgrade-hint" id="upgrade-hint">
                        Create up to 5 templates on the free plan. <a href="/pricing.html" style="color: #8b5cf6;">Upgrade for unlimited templates</a>
                    </div>
                </div>
            </div>

            <!-- Value Proposition Section (for non-authenticated users) -->
            <div class="value-section" id="value-section">
                <h2 style="text-align: center; color: #8b5cf6; margin-bottom: 2rem;">ğŸš€ Why Use Templates?</h2>
                <div class="value-grid">
                    <div class="value-card">
                        <div class="value-icon">âš¡</div>
                        <div class="value-title">Save Time</div>
                        <div class="value-description">Respond to DMs 10x faster with pre-written templates</div>
                    </div>
                    <div class="value-card">
                        <div class="value-icon">ğŸ¯</div>
                        <div class="value-title">Stay Consistent</div>
                        <div class="value-description">Maintain your brand voice across all conversations</div>
                    </div>
                    <div class="value-card">
                        <div class="value-icon">ğŸ”„</div>
                        <div class="value-title">Reuse Everything</div>
                        <div class="value-description">One template works across Instagram, TikTok, Twitter & more</div>
                    </div>
                    <div class="value-card">
                        <div class="value-icon">âœ¨</div>
                        <div class="value-title">AI Enhanced</div>
                        <div class="value-description">Templates get enhanced by AI for even better responses</div>
                    </div>
                </div>
            </div>

            <!-- Example Templates Section -->
            <div class="examples-section" id="examples-section">
                <h3 style="color: #ffffff; margin-bottom: 1rem;">ğŸ“‹ Popular Template Examples</h3>
                <p style="color: #9ca3af; margin-bottom: 1rem;">Get started with these proven templates. Sign up to customize and save your own!</p>
                
                <div class="examples-grid">
                    <div class="example-card">
                        <div class="example-header">
                            <div class="example-name">ğŸ¤ Collaboration Interest</div>
                            <button class="btn btn-small btn-secondary" onclick="useExample('collaboration')">ğŸ“‹ Use This</button>
                        </div>
                        <div class="example-response">
                            "Thanks for reaching out! I'm definitely interested in collaborating. Let me check my calendar and get back to you with some ideas. What kind of timeline were you thinking?"
                        </div>
                    </div>
                    
                    <div class="example-card">
                        <div class="example-header">
                            <div class="example-name">ğŸ’• Fan Appreciation</div>
                            <button class="btn btn-small btn-secondary" onclick="useExample('fan')">ğŸ“‹ Use This</button>
                        </div>
                        <div class="example-response">
                            "This made my day! Thank you so much for the kind words and support. It truly means everything to me! ğŸ™âœ¨"
                        </div>
                    </div>
                    
                    <div class="example-card">
                        <div class="example-header">
                            <div class="example-name">â“ Question Response</div>
                            <button class="btn btn-small btn-secondary" onclick="useExample('question')">ğŸ“‹ Use This</button>
                        </div>
                        <div class="example-response">
                            "Great question! I actually covered this in my recent post/story. Check it out and let me know if you need any clarification!"
                        </div>
                    </div>
                    
                    <div class="example-card">
                        <div class="example-header">
                            <div class="example-name">ğŸ’¼ Business Inquiry</div>
                            <button class="btn btn-small btn-secondary" onclick="useExample('business')">ğŸ“‹ Use This</button>
                        </div>
                        <div class="example-response">
                            "Thanks for your interest! I'd love to discuss this opportunity. Please email me at [email] with more details and we can set up a call."
                        </div>
                    </div>
                </div>
            </div>

            <!-- Templates Section -->
            <div class="templates-section">
                <div class="section-header">
                    <h2 class="section-title">Your Templates</h2>
                    <button class="btn btn-primary" id="add-template-btn" onclick="showTemplateForm()">
                        â• Add Template
                    </button>
                </div>

                <!-- Template Creation Form -->
                <div id="template-form" class="template-form hidden">
                    <h3 style="margin-bottom: 1.5rem;">Create New Template</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="template-name">Template Name:</label>
                            <input 
                                type="text"
                                class="form-input" 
                                id="template-name" 
                                placeholder="e.g., Collaboration Response"
                                oninput="updatePreview()"
                            />
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="template-category">Category:</label>
                            <select class="form-select" id="template-category" onchange="updatePreview()">
                                <option value="collaboration">ğŸ¤ Collaboration (partnerships, collabs)</option>
                                <option value="compliment">ğŸ’• Compliment (fan responses, praise)</option>
                                <option value="question">â“ Question (info requests, FAQs)</option>
                                <option value="business">ğŸ’¼ Business (work inquiries, deals)</option>
                                <option value="support">ğŸ¤— Support (encouragement, help)</option>
                                <option value="promotional">ğŸ“¢ Promotional (product mentions, ads)</option>
                                <option value="other">ğŸ“Œ Other (custom responses)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="template-response">Template Response:</label>
                        <textarea 
                            class="form-textarea" 
                            id="template-response" 
                            placeholder="Enter your template response here..."
                            rows="4"
                            oninput="updatePreview()"
                        ></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="template-tags">Tags (Optional):</label>
                        <input 
                            type="text"
                            class="form-input" 
                            id="template-tags" 
                            placeholder="collaboration, brand, partnership (comma separated)"
                            oninput="updatePreview()"
                        />
                    </div>

                    <!-- Live Preview -->
                    <div class="preview-section">
                        <div class="preview-label">ğŸ“‹ Template Preview:</div>
                        <div class="preview-content" id="template-preview">
                            Start typing above to see your template preview...
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 1.5rem;">
                        <button class="btn btn-secondary" onclick="hideTemplateForm()">Cancel</button>
                        <button class="btn btn-primary" onclick="saveTemplate()">ğŸ’¾ Save Template</button>
                    </div>
                </div>

                <!-- Templates List -->
                <div id="templates-list">
                    <!-- Templates will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Authentication Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
            <button class="modal-close" onclick="hideAuthModal()">Ã—</button>
            <div class="auth-modal-header">
                <h2 id="auth-modal-title">Sign In</h2>
                <p id="auth-modal-subtitle">Access your template library</p>
            </div>
            
            <div id="error-message" class="error-message hidden"></div>
            <div id="success-message" class="success-message hidden"></div>
            
            <div id="name-fields" class="form-grid hidden">
                <div class="form-group">
                    <label class="form-label" for="first-name">First Name:</label>
                    <input type="text" class="form-input" id="first-name" />
                </div>
                <div class="form-group">
                    <label class="form-label" for="last-name">Last Name:</label>
                    <input type="text" class="form-input" id="last-name" />
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="email">Email:</label>
                <input type="email" class="form-input" id="email" />
            </div>
            
            <div class="form-group">
                <label class="form-label" for="password">Password:</label>
                <input type="password" class="form-input" id="password" />
            </div>
            
            <button class="btn btn-primary" id="auth-submit-btn" onclick="handleAuth()" style="width: 100%;">
                Sign In
            </button>
            
            <div style="text-align: center; margin-top: 1rem;">
                <p>
                    <span id="auth-switch-text">Don't have an account?</span>
                    <button id="auth-switch-btn" onclick="toggleAuthMode()" style="background: none; border: none; color: #8b5cf6; text-decoration: underline; cursor: pointer;">Sign Up</button>
                </p>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentUser = null;
        let isAuthenticated = false;
        let isLoginMode = true;
        let userTemplates = [];
        
        // API Configuration
        const API_BASE = 'https://dmtools-backend-production.up.railway.app/api';

        // Template Examples
        const templateExamples = {
            collaboration: {
                name: "Collaboration Interest",
                category: "collaboration",
                response: "Thanks for reaching out! I'm definitely interested in collaborating. Let me check my calendar and get back to you with some ideas. What kind of timeline were you thinking?",
                tags: ["collaboration", "partnership", "business"]
            },
            fan: {
                name: "Fan Appreciation", 
                category: "compliment",
                response: "This made my day! Thank you so much for the kind words and support. It truly means everything to me! ğŸ™âœ¨",
                tags: ["appreciation", "fan", "gratitude"]
            },
            question: {
                name: "Question Response",
                category: "question", 
                response: "Great question! I actually covered this in my recent post/story. Check it out and let me know if you need any clarification!",
                tags: ["question", "faq", "help"]
            },
            business: {
                name: "Business Inquiry",
                category: "business",
                response: "Thanks for your interest! I'd love to discuss this opportunity. Please email me at [email] with more details and we can set up a call.",
                tags: ["business", "inquiry", "opportunity"]
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', initializeApp);

        async function initializeApp() {
            console.log('ğŸš€ Initializing DMTools Templates Page...');
            
            try {
                // Check authentication
                const token = localStorage.getItem('authToken');
                if (token) {
                    try {
                        const response = await apiCall('/user/profile');
                        currentUser = response.user;
                        isAuthenticated = true;
                        await loadUserTemplates();
                    } catch (error) {
                        localStorage.removeItem('authToken');
                        isAuthenticated = false;
                    }
                }
                
                updateUI();
                
                console.log('âœ… Templates page initialized successfully');
            } catch (error) {
                console.error('Error during app initialization:', error);
            }
        }

        // API Call Function
        async function apiCall(endpoint, options = {}) {
            const token = localStorage.getItem('authToken');
            const url = `${API_BASE}${endpoint}`;
            
            const config = {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    ...(token && { 'Authorization': `Bearer ${token}` })
                },
                ...options
            };

            const response = await fetch(url, config);
            
            if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                throw new Error(errorData.error || `Request failed: ${response.status}`);
            }

            return response.json();
        }

        // Update UI based on auth status
        function updateUI() {
            const authSection = document.getElementById('auth-section');
            const userSection = document.getElementById('user-section');
            const usageTracker = document.getElementById('usage-tracker');
            const valueSection = document.getElementById('value-section');
            const examplesSection = document.getElementById('examples-section');
            const addTemplateBtn = document.getElementById('add-template-btn');

            if (isAuthenticated) {
                authSection.classList.add('hidden');
                userSection.classList.remove('hidden');
                usageTracker.classList.remove('hidden');
                valueSection.classList.add('hidden');
                examplesSection.classList.add('hidden');
                addTemplateBtn.classList.remove('hidden');
                
                // Update user email
                document.getElementById('user-email').textContent = currentUser?.email || 'user@example.com';
                
                // Update usage tracker
                updateUsageTracker();
                
            } else {
                authSection.classList.remove('hidden');
                userSection.classList.add('hidden');
                usageTracker.classList.add('hidden');
                valueSection.classList.remove('hidden');
                examplesSection.classList.remove('hidden');
                addTemplateBtn.innerHTML = 'ğŸ” Sign In to Create Templates';
                addTemplateBtn.onclick = () => showAuthModal(true);
            }

            updateTemplatesList();
        }

        // Update usage tracker
        function updateUsageTracker() {
            if (!isAuthenticated) return;

            const limits = { 
                free: 5, 
                starter: 10,
                pro: 20, 
                business: 200,
                enterprise: 500 
            };
            
            const userPlan = currentUser?.plan || 'free';
            const limit = limits[userPlan];
            const count = userTemplates.length;
            const percentage = Math.min((count / limit) * 100, 100);

            document.getElementById('template-count').textContent = count;
            document.getElementById('template-limit').textContent = limit;
            document.getElementById('usage-progress').style.width = percentage + '%';
            document.getElementById('plan-badge').textContent = userPlan.charAt(0).toUpperCase() + userPlan.slice(1) + ' Plan';

            const upgradeHint = document.getElementById('upgrade-hint');
            if (count >= limit * 0.8) {
                upgradeHint.innerHTML = `You're approaching your limit. <a href="/pricing.html" style="color: #8b5cf6;">Upgrade for more templates</a>`;
            } else {
                upgradeHint.innerHTML = `Create up to ${limit} templates on the ${userPlan} plan. <a href="/pricing.html" style="color: #8b5cf6;">Upgrade for more</a>`;
            }
        }

        // Template Management Functions
        function showTemplateForm() {
            if (!isAuthenticated) {
                showNotification('Please sign in to create templates', 'error');
                showAuthModal(true);
                return;
            }
            
            const limits = { 
                free: 5, 
                starter: 10,
                pro: 20, 
                business: 200,
                enterprise: 500 
            };
            const limit = limits[currentUser?.plan || 'free'];
            
            if (userTemplates.length >= limit) {
                showNotification(`Template limit reached (${limit}). Upgrade to add more templates.`, 'error');
                return;
            }
            
            document.getElementById('template-form').classList.remove('hidden');
        }

        function hideTemplateForm() {
            document.getElementById('template-form').classList.add('hidden');
            clearTemplateForm();
        }

        function clearTemplateForm() {
            document.getElementById('template-name').value = '';
            document.getElementById('template-response').value = '';
            document.getElementById('template-tags').value = '';
            document.getElementById('template-category').value = 'collaboration';
            updatePreview();
        }

        function updatePreview() {
            const name = document.getElementById('template-name').value.trim();
            const response = document.getElementById('template-response').value.trim();
            const preview = document.getElementById('template-preview');
            
            if (!name && !response) {
                preview.textContent = 'Start typing above to see your template preview...';
                preview.style.opacity = '0.5';
            } else {
                preview.textContent = response || 'Enter your response text...';
                preview.style.opacity = '1';
            }
        }

        async function saveTemplate() {
            const name = document.getElementById('template-name').value.trim();
            const category = document.getElementById('template-category').value;
            const response = document.getElementById('template-response').value.trim();
            const tagsInput = document.getElementById('template-tags').value.trim();
            
            // Convert comma-separated tags to array
            const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0) : [];
            
            if (!name || !response) {
                showNotification('Template name and response are required', 'error');
                return;
            }

            try {
                await apiCall('/presets', {
                    method: 'POST',
                    body: JSON.stringify({
                        name: name,
                        category: category,
                        response: response,
                        tags: tags
                    })
                });

                await loadUserTemplates();
                hideTemplateForm();
                showNotification('Template saved successfully!', 'success');
                updateUsageTracker();
                
            } catch (error) {
                showNotification(error.message || 'Failed to save template', 'error');
            }
        }

        async function deleteTemplate(id) {
            if (!confirm('Are you sure you want to delete this template?')) return;

            try {
                await apiCall(`/presets/${id}`, {
                    method: 'DELETE'
                });

                await loadUserTemplates();
                showNotification('Template deleted successfully', 'success');
                updateUsageTracker();
                
            } catch (error) {
                showNotification(error.message || 'Failed to delete template', 'error');
            }
        }

        async function copyTemplate(text, button) {
            try {
                await navigator.clipboard.writeText(text);
                
                // Visual feedback
                const originalText = button.innerHTML;
                button.innerHTML = 'âœ… Copied to Clipboard!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.classList.remove('copied');
                }, 2000);

                showNotification('Template copied to clipboard!', 'success');
                
            } catch (error) {
                showNotification('Failed to copy template', 'error');
            }
        }

        function useExample(type) {
            const example = templateExamples[type];
            if (!example) return;

            if (isAuthenticated) {
                // Fill the form with the example
                document.getElementById('template-name').value = example.name;
                document.getElementById('template-category').value = example.category;
                document.getElementById('template-response').value = example.response;
                document.getElementById('template-tags').value = example.tags.join(', ');
                updatePreview();
                showTemplateForm();
            } else {
                // Copy to clipboard and show signup prompt
                navigator.clipboard.writeText(example.response).then(() => {
                    showNotification('Template copied! Sign up to save and customize templates.', 'info');
                    setTimeout(() => showAuthModal(false), 2000);
                });
            }
        }

        async function loadUserTemplates() {
            if (!isAuthenticated) {
                userTemplates = [];
                return;
            }

            try {
                const response = await apiCall('/presets');
                userTemplates = response.presets || [];
            } catch (error) {
                console.error('Failed to load templates:', error);
                userTemplates = [];
            }
        }

        function updateTemplatesList() {
            const container = document.getElementById('templates-list');
            if (!container) return;
            
            if (!isAuthenticated || userTemplates.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“</div>
                        <div class="empty-title">${isAuthenticated ? 'No templates saved yet' : 'Sign in to view your templates'}</div>
                        <div class="empty-description">
                            ${isAuthenticated 
                                ? 'Click "Add Template" to create your first response template!' 
                                : 'Create and manage your custom response templates for quick message responses.'
                            }
                        </div>
                        ${!isAuthenticated ? `
                            <button class="btn btn-primary" onclick="showAuthModal(false)" style="margin-top: 1rem;">
                                Get Started Free
                            </button>
                        ` : ''}
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <div class="template-grid">
                    ${userTemplates.map(template => {
                        // Sanitize all user-generated content to prevent XSS
                        const sanitizedName = DOMPurify.sanitize(template.name);
                        const sanitizedCategory = DOMPurify.sanitize(template.category);
                        const sanitizedResponse = DOMPurify.sanitize(template.response);
                        const sanitizedResponseForCopy = template.response.replace(/`/g, '\\`').replace(/\$/g, '\\$');
                        
                        return `
                        <div class="template-card">
                            <div class="template-header">
                                <div class="template-info">
                                    <div class="template-name">
                                        ${getCategoryIcon(template.category)} ${sanitizedName}
                                    </div>
                                    <div class="template-category">${sanitizedCategory}</div>
                                </div>
                                <div class="template-actions">
                                    <button class="copy-btn" onclick="copyTemplate(\`${sanitizedResponseForCopy}\`, this)">
                                        ğŸ“‹ Copy
                                    </button>
                                    <button class="delete-btn" onclick="deleteTemplate(${template.id})" title="Delete template">
                                        ğŸ—‘ï¸
                                    </button>
                                </div>
                            </div>
                            <div class="template-response">${sanitizedResponse}</div>
                            ${template.tags && template.tags.length > 0 ? `
                                <div class="template-tags">
                                    ${template.tags.map(tag => `<span class="tag">${DOMPurify.sanitize(tag)}</span>`).join('')}
                                </div>
                            ` : ''}
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function getCategoryIcon(category) {
            const icons = {
                collaboration: 'ğŸ¤',
                compliment: 'ğŸ’•',
                question: 'â“',
                business: 'ğŸ’¼',
                support: 'ğŸ¤—',
                promotional: 'ğŸ“¢',
                other: 'ğŸ“Œ'
            };
            return icons[category] || 'ğŸ“Œ';
        }

        // Authentication Functions
        function showAuthModal(loginMode) {
            isLoginMode = loginMode;
            updateAuthModalUI();
            document.getElementById('auth-modal').classList.add('show');
        }

        function hideAuthModal() {
            document.getElementById('auth-modal').classList.remove('show');
            clearAuthForm();
        }

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            updateAuthModalUI();
        }

        function updateAuthModalUI() {
            const title = document.getElementById('auth-modal-title');
            const subtitle = document.getElementById('auth-modal-subtitle');
            const nameFields = document.getElementById('name-fields');
            const submitBtn = document.getElementById('auth-submit-btn');
            const switchText = document.getElementById('auth-switch-text');
            const switchBtn = document.getElementById('auth-switch-btn');

            if (isLoginMode) {
                title.textContent = 'Sign In';
                subtitle.textContent = 'Access your template library';
                nameFields.classList.add('hidden');
                submitBtn.textContent = 'Sign In';
                switchText.textContent = "Don't have an account?";
                switchBtn.textContent = 'Sign Up';
            } else {
                title.textContent = 'Create Account';
                subtitle.textContent = 'Start building your template collection';
                nameFields.classList.remove('hidden');
                submitBtn.textContent = 'Create Account';
                switchText.textContent = 'Already have an account?';
                switchBtn.textContent = 'Sign In';
            }
        }

        async function handleAuth() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!email || !password) {
                showAuthError('Email and password are required');
                return;
            }

            const submitBtn = document.getElementById('auth-submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.disabled = true;
            submitBtn.textContent = 'Processing...';

            try {
                if (isLoginMode) {
                    const response = await apiCall('/user/login', {
                        method: 'POST',
                        body: JSON.stringify({ email, password })
                    });
                    
                    localStorage.setItem('authToken', response.token);
                    currentUser = response.user;
                    isAuthenticated = true;
                    
                } else {
                    const firstName = document.getElementById('first-name').value.trim();
                    const lastName = document.getElementById('last-name').value.trim();
                    
                    if (!firstName || !lastName) {
                        showAuthError('First name and last name are required');
                        return;
                    }

                    const response = await apiCall('/user/register', {
                        method: 'POST',
                        body: JSON.stringify({
                            email,
                            password,
                            first_name: firstName,
                            last_name: lastName
                        })
                    });
                    
                    localStorage.setItem('authToken', response.token);
                    currentUser = response.user;
                    isAuthenticated = true;
                }

                await loadUserTemplates();
                updateUI();
                hideAuthModal();
                showNotification(`Successfully ${isLoginMode ? 'signed in' : 'registered'}!`, 'success');

            } catch (error) {
                showAuthError(error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        function logout() {
            localStorage.removeItem('authToken');
            currentUser = null;
            isAuthenticated = false;
            userTemplates = [];
            updateUI();
            showNotification('Signed out successfully', 'info');
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        function clearAuthForm() {
            const fields = ['email', 'password', 'first-name', 'last-name'];
            fields.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            
            const errorDiv = document.getElementById('error-message');
            const successDiv = document.getElementById('success-message');
            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: ${type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : '#3b82f6'};
                color: white;
                padding: 1rem 2rem;
                border-radius: 12px;
                box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                z-index: 10001;
                font-weight: 600;
                max-width: 400px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            // Animate in
            requestAnimationFrame(() => {
                notification.style.transform = 'translateX(0)';
            });

            // Animate out and remove
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('auth-modal');
            if (event.target === modal) {
                hideAuthModal();
            }
        });

        console.log('âœ… DMTools Templates page fully loaded and optimized');
    </script>
</body>
</html>
